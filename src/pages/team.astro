---
import Layout from "../layouts/Layout.astro";
import {teamMembers} from "../constants";
import type {TeamMember} from "../types";

const bySubTeam = (subTeam: "Team Captain" | "Hardware" | "Software" | "Outreach" | "Mentor") => teamMembers.filter((m: TeamMember): boolean => m.subTeam === subTeam);
const teamCaptain: TeamMember[] = bySubTeam("Team Captain");
const hardwareTeam: TeamMember[] = bySubTeam("Hardware");
const softwareTeam: TeamMember[] = bySubTeam("Software");
const outreachTeam: TeamMember[] = bySubTeam("Outreach");
const mentors: TeamMember[] = bySubTeam("Mentor");
---

<Layout title="Our Team">
    <main class="main-content">
        <section class="hero">
            <div class="hero-content">
                <h1 class="hero-title">Our Team</h1>
                <p class="hero-subtitle">Together, we are TURBΩ.</p>
                <p class="hero-description">
                    At TURBΩ V8, we fuel future STEM leadership by accelerating innovation
                    and propelling communities forward through collaborative mentorship.
                </p>
            </div>
        </section>

        <section class="section">
            <div class="container">
                {teamCaptain.length > 0 && (
                        <div class="team-category mb-6 px-2">
                            <h2 class="section-title mb-4">Team Captain</h2>
                            <div class="grid-auto-fit team-grid">
                                {teamCaptain.map((m) => (
                                        <div class="card card-hover team-member p-4">
                                            <div class="member-photo circular-image mb-3">
                                                <img class="image-cover" src={(m.image as any).src ?? (m.image as any)}
                                                     alt={m.name} loading="eager"/>
                                            </div>
                                            <div class="member-text">
                                                <p class="member-role text-red text-uppercase mb-0"
                                                   title={m.role}>{m.role}</p>
                                                <h3 class="member-name" title={m.name}>{m.name}</h3>
                                            </div>
                                        </div>
                                ))}
                            </div>
                        </div>
                )}
                {hardwareTeam.length > 0 && (
                        <div class="team-category mb-6 px-2">
                            <h2 class="section-title mb-4">Hardware Team</h2>
                            <div class="grid-auto-fit team-grid">
                                {hardwareTeam.map((m) => (
                                        <div class="card card-hover team-member p-4">
                                            <div class="member-photo circular-image image-hover-scale mb-3">
                                                <img class="image-cover" src={(m.image as any).src ?? (m.image as any)}
                                                     alt={m.name} loading="eager"/>
                                            </div>
                                            <div class="member-text">
                                                <p class="member-role text-red text-uppercase mb-0"
                                                   title={m.role}>{m.role}</p>
                                                <h3 class="member-name" title={m.name}>{m.name}</h3>
                                            </div>
                                        </div>
                                ))}
                            </div>
                        </div>
                )}
                {softwareTeam.length > 0 && (
                        <div class="team-category mb-6 px-2">
                            <h2 class="section-title mb-4">Software Team</h2>
                            <div class="grid-auto-fit team-grid">
                                {softwareTeam.map((m) => (
                                        <div class="card card-hover team-member p-4">
                                            <div class="member-photo circular-image image-hover-scale mb-3">
                                                <img class="image-cover" src={(m.image as any).src ?? (m.image as any)}
                                                     alt={m.name} loading="eager"/>
                                            </div>
                                            <div class="member-text">
                                                <p class="member-role text-red text-uppercase mb-0"
                                                   title={m.role}>{m.role}</p>
                                                <h3 class="member-name" title={m.name}>{m.name}</h3>
                                            </div>
                                        </div>
                                ))}
                            </div>
                        </div>
                )}
                {outreachTeam.length > 0 && (
                        <div class="team-category mb-6 px-2">
                            <h2 class="section-title mb-4">Outreach Team</h2>
                            <div class="grid-auto-fit team-grid">
                                {outreachTeam.map((m) => (
                                        <div class="card card-hover team-member p-4">
                                            <div class="member-photo circular-image image-hover-scale mb-3">
                                                <img class="image-cover" src={(m.image as any).src ?? (m.image as any)}
                                                     alt={m.name} loading="eager"/>
                                            </div>
                                            <div class="member-text">
                                                <p class="member-role text-red text-uppercase mb-0"
                                                   title={m.role}>{m.role}</p>
                                                <h3 class="member-name" title={m.name}>{m.name}</h3>
                                            </div>
                                        </div>
                                ))}
                            </div>
                        </div>
                )}
                {mentors.length > 0 && (
                        <div class="team-category px-2">
                            <h2 class="section-title mb-4">Mentors</h2>
                            <div class="grid-auto-fit team-grid">
                                {mentors.map((m) => (
                                        <div class="card card-hover team-member p-4">
                                            <div class="member-photo circular-image image-hover-scale mb-3">
                                                <img class="image-cover" src={(m.image as any).src ?? (m.image as any)}
                                                     alt={m.name} loading="eager"/>
                                            </div>
                                            <div class="member-text">
                                                <p class="member-role text-red text-uppercase mb-0"
                                                   title={m.role}>{m.role}</p>
                                                <h3 class="member-name" title={m.name}>{m.name}</h3>
                                            </div>
                                        </div>
                                ))}
                            </div>
                        </div>
                )}
            </div>
        </section>
    </main>
</Layout>

<style>
    /* Custom styles specific to team page */
    .team-member {
        text-align: center;
        width: 100%;
        max-width: 280px;
        display: flex;
        flex-direction: column;
        height: 100%;
        align-items: center;
    }

    /* Stretch items in team grids to equal height */
    .team-grid {
        align-items: stretch;
    }

    .member-photo {
        width: 120px;
        height: 120px;
        margin: 0 auto 1.5rem;
        flex: 0 0 auto;
    }

    .member-text {
        margin-top: auto; /* push text block to the bottom for consistent alignment */
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .member-name {
        font-size: 1.3rem;
        color: white;
        font-weight: bold;
        margin: 0.5rem 0 0;
        /* two-line clamp for consistent heights */
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        line-height: 1.2;
        min-height: 3.2rem; /* ~2 lines at 1.3rem * 1.2 */
        max-height: 3.2rem; /* enforce two-line cap across browsers */
        word-break: break-word;
    }

    .member-role {
        font-size: 1rem;
        font-weight: 600;
        /* reserve at least one line of height to avoid shifting */
        min-height: 1.4rem;
        /* prevent wrapping that causes stacked lines */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .member-photo {
            width: 100px;
            height: 100px;
        }

        /* keep two-line height on mobile as well */
        .member-name {
            min-height: 3rem;
        }
    }
</style>